#####################################################################################
###################             Наборы колонок для olap             #################
#####################################################################################

#====================================================================================
#Колонки для стандартного OLAP отчета (по колонкам Б1 и PLAN)
#------------------------------------------------------------------------------------
subset cs_olap_default, "Cтандартный OLAP отчет (по Б1 и PLAN)" :
#	ask useplan
#	ask usepredsng
#	ask useotkl
#	ask useotkltype
	var useplan, "Вывести планы", target=condition, group=_ГП_ВРЕМЯ, altvalue=PLAN, type=bool : true
	var usepredyear, "Вывести предыдущий год", target=condition, group=_ГП_ВРЕМЯ, altvalue=PREDYEAR, type=bool : true
	var useotkl, "Вывести отклонения", target=condition, group=_ГП_ВРЕМЯ, altvalue=OTKL, type=bool : true
	var useotkltype, "Тип отклонения", target=condition, group=_ГП_ВРЕМЯ, altvalue=OTKL, radio=true : 
		listdefinition = "OTKLABS:Абсолютное|OTKLOTN:Относительное"
		defaultvalue="OTKLABS"

	col Б1, "Факт {2} {0}", customCode="PREDFACT", condition="PREDYEAR", year=-1, forperiods="_ТОЛЬКО_МЕС,1,2,3,4,_ОЖИД_СНГ"

	col PLAN, "План {2} {0}", customCode="PLAN", forperiods="11,12,13", format=_INT, condition="PLAN", formula=" @PLAN.P303? / 3"
	col PLANKV, "План {2} {0}", customCode="PLAN", forperiods="14,15,16", format=_INT, condition="PLAN", formula=" ( @PLAN.P306? - @PLAN.P303? ) / 3"
	col PLANKV, "План {2} {0}", customCode="PLAN", forperiods="17,18,19", format=_INT, condition="PLAN", formula=" ( @PLAN.P309? - @PLAN.P306? ) / 3 "
	col PLANKV, "План {2} {0}", customCode="PLAN", forperiods="110,111,112", format=_INT, condition="PLAN", formula=" ( @PLAN.P301? - @PLAN.P309? ) / 3"
	col PLAN, "План I кв {0}", customCode="PLAN", period=303, forperiods=1, format=_INT, condition="PLAN"
	col PLAN, "План I пг {0}", customCode="PLAN", period=306, forperiods="2,406", format=_INT, condition="PLAN"
	col PLAN, "План 9 мес. {0}", customCode="PLAN", period=309, forperiods=3, format=_INT, condition="PLAN"
	col PLAN, "План {0}", customCode="PLAN", period=301, forperiods=4, format=_INT, condition="PLAN"

	col PLAN, "ТПФП {0}", customCode="PLANPRED", period=301, year=-1, forperiods="301,251,252,253,254,303,306,309,401", condition="PLAN"

	col Б1, "Факт {2} {0}", customCode="FACT", forperiods="_ТОЛЬКО_МЕС,1,2,3,4,_ОЖИД_СНГ"
	col PLAN, "Ожид. {0}", customCode="OZHID", period=401, year=-1, forperiods="301,251,252,253,254", condition="PREDYEAR"
	col PLAN, "{2} {0}",  forperiods="301,251,252,253,254,303,306,309"

	col OTKLFACT, "Откл. от факта {2} {3}", formula=" @FACT? - @PREDFACT? ", forperiods="_ТОЛЬКО_МЕС,1,2,3,4,_ОЖИД_СНГ", condition="OTKL and PREDYEAR and OTKLABS ", format=_INT
	col OTKLPLAN, "Откл. от плана {2} {0}", formula=" @FACT? - @PLAN? ", forperiods="_ТОЛЬКО_МЕС,1,2,3,4,_ОЖИД_СНГ", condition="OTKL and PLAN and OTKLABS ", format=_INT
	col OTKLPLAN, "Откл. от ТПФП {3}", formula=" @PLAN? - @PLANPRED? ", forperiods="301,251,252,253,254", condition="OTKL and PLAN and OTKLABS ", format=_INT
	col OTKLFACT, "Откл. от ожид. {3}", formula=" @PLAN? - @OZHID? ", forperiods="301,251,252,253,254", condition="OTKL and PREDYEAR and OTKLABS ", format=_INT
	
	col OTKLFACT, "% от факта {2} {3}", formula=" @FACT? / @PREDFACT? * 100 ", forperiods="_ТОЛЬКО_МЕС,1,2,3,4,_ОЖИД_СНГ", condition="OTKL and PREDYEAR and OTKLOTN ", format=_DEC1
	col OTKLPLAN, "% от плана {2} {0}", formula=" @FACT? / @PLAN? * 100 ", forperiods="_ТОЛЬКО_МЕС,1,2,3,4,_ОЖИД_СНГ", condition="OTKL and PLAN and OTKLOTN ", format=_DEC1
	col OTKLPLAN, "% от ТПФП {0}", formula=" @PLAN? / @PLANPRED? * 100", forperiods="301,251,252,253,254", condition="OTKL and PLAN and OTKLOTN ", format=_DEC1
	col OTKLFACT, "% от ожид. {3}", formula=" @PLAN? / @OZHID? * 100", forperiods="301,251,252,253,254", condition="OTKL and PREDYEAR and OTKLOTN ", format=_DEC1

#====================================================================================
#Колонки для стандартного OLAP отчета (по колонкам Б1 и PLAN)
#------------------------------------------------------------------------------------
subset cs_cross_default, "Стандартный отчет-шахматка" :
	col Б1, "Факт {2} {0}", forperiods="1,2,3,4,11,12,13,14,15,16,17,18,19,110,111,112,22,24,25,27,28,210,211,403,406,409"
	col PLAN, "План {2} {0}", forperiods="301,251,252,253,254"
	col PLAN, "Ожид. {0}", forperiods="401"
	col PLANC, "Корректив {2} {0}", forperiods="31,32,33,34"

#====================================================================================
#Колонки для отчета по расходам на собственные нужды (OLAP)
#------------------------------------------------------------------------------------
subset cs_rashsn_olap, "Отчет по расходам на собственные нужды (OLAP)" :
	col PLAN, "Ожидаемое {0}", customCode=OSHIDPLAN, period=401, year=-1, forperiods="251"
	col Б1, "Факт {0}", customCode=FACTPRED, period=_СУММЕСЯЦ, year=-1, forperiods="252,253,254"
	col PLAN, "ТПФП {0}", customCode=PLANTEK, forperiods="251,252,253,254"
	col PLANOTKL, "Откл.", formula=" @PLANTEK? - @OSHIDPLAN? ", forperiods="251"
	col PLANOTKL, "Откл.", formula=" @PLANTEK? - @FACTPRED? ", forperiods="252,253,254"
		
	col PLAN, _PLAN, period=303, forperiods="1"
	col PLAN, _PLAN, period=306, forperiods="2"
	col PLAN, _PLAN, period=309, forperiods="3"
	col PLAN, _PLAN, period=301, forperiods="4"
	col Б1, _FACT, forperiods="1,2,3,4"
	col OTKL, "Откл.", formula=" @Б1? - @PLAN.P303? ", forperiods="1"
	col OTKL, "Откл.", formula=" @Б1? - @PLAN.P306? ", forperiods="2"
	col OTKL, "Откл.", formula=" @Б1? - @PLAN.P309? ", forperiods="3"
	col OTKL, "Откл.", formula=" @Б1? - @PLAN.P301? ", forperiods="4"

























































































































































































































































































































































































































































































































































































































































































































































































































































































